      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV
      USE NMPRD_INT, ONLY: IQUIT
      USE PRCM_INT,  ONLY: MC0000=>PRMC,ME0000=>PRME
      USE PRCM_INT,  ONLY: MG0000=>PRMG,MT0000=>PRMT
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      INTEGER NEWIND
      REAL(KIND=DPSIZE) :: EVTREC
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,71,*)
      IF (ICALL <= 1) THEN
      CALL ASSOCNMPRD4
      MC0000(1)=30
      ME0000(1)=70
      MG0000(1)=080
      MT0000(1)=70
      IDEF(1,001)= -9
      IDEF(1,002)= -1
      IDEF(1,003)=  0
      IDEF(1,004)=  0
      IDEF(2,003)=  0
      IDEF(2,004)=  0
      IDEF(3,002)=  7
      IDEF(4,001)=  6
      CALL GETETA(ETA)
      IF (IQUIT == 1) RETURN
      RETURN
      ENDIF
      IF (NEWIND /= 2) THEN
       IF (ICALL == 4) THEN
        CALL SIMETA(ETA)
       ELSE
        CALL GETETA(ETA)
       ENDIF
       IF (IQUIT == 1) RETURN
      ENDIF
      PROT=EVTREC(NVNT,03)
      BMI=EVTREC(NVNT,12)
      CRCL=EVTREC(NVNT,13)
      DOSE=EVTREC(NVNT,14)
      B00001=CRCL-60.23D0
      B00002=1.D0+THETA(08)*B00001
      V2CRCL=B00002
      B00003=BMI-26.73D0
      B00004=1.D0+THETA(07)*B00003
      V2BMI=B00004
      V2COV=V2BMI*V2CRCL
      STRT=PROT*1000.D0+DOSE
      TVCL=DEXP(THETA(01))
      MU_1=DLOG(TVCL)
      MU_(001)=MU_1
      B00005=MU_1+ETA(01)
      B00006=DEXP(B00005)
      CL=B00006
!                      A00073 = DERIVATIVE OF CL W.R.T. ETA(01)
      A00073=B00006
      TVV2=DEXP(THETA(02))
      TVV2=V2COV*TVV2
      MU_2=DLOG(TVV2)
      MU_(002)=MU_2
      B00008=MU_2+ETA(02)
      B00009=DEXP(B00008)
      V2=B00009
!                      A00078 = DERIVATIVE OF V2 W.R.T. ETA(02)
      A00078=B00009
      TVKA=THETA(03)
      MU_3=DLOG(TVKA)
      MU_(003)=MU_3
      B00010=MU_3+ETA(03)
      B00011=DEXP(B00010)
      KA=B00011
!                      A00083 = DERIVATIVE OF KA W.R.T. ETA(03)
      A00083=B00011
      TVF1=THETA(04)
      F1=TVF1
      TVQ=DEXP(THETA(05))
      MU_4=DLOG(TVQ)
      MU_(004)=MU_4
      B00012=MU_4+ETA(04)
      B00013=DEXP(B00012)
      Q=B00013
!                      A00088 = DERIVATIVE OF Q W.R.T. ETA(04)
      A00088=B00013
      TVV3=DEXP(THETA(06))
      MU_5=DLOG(TVV3)
      MU_(005)=MU_5
       RETURN
      B00014=MU_5+ETA(05)
      B00015=DEXP(B00014)
      V3=B00015
!                      A00093 = DERIVATIVE OF V3 W.R.T. ETA(05)
      A00093=B00015
      S2=V2*624.709D0/1.D6
      B00016=624.709D0/1.D6
!                      A00096 = DERIVATIVE OF S2 W.R.T. ETA(02)
      A00096=B00016*A00078
      GG(01,1,1)=CL
      GG(01,02,1)=A00073
      GG(02,1,1)=V2
      GG(02,03,1)=A00078
      GG(03,1,1)=Q
      GG(03,05,1)=A00088
      GG(04,1,1)=V3
      GG(04,06,1)=A00093
      GG(05,1,1)=KA
      GG(05,04,1)=A00083
      GG(06,1,1)=F1
      GG(07,1,1)=S2
      GG(07,03,1)=A00096
      IF (MSEC == 1) THEN
!                      A00075 = DERIVATIVE OF A00073 W.R.T. ETA(01)
      A00075=B00006
!                      A00080 = DERIVATIVE OF A00078 W.R.T. ETA(02)
      A00080=B00009
!                      A00085 = DERIVATIVE OF A00083 W.R.T. ETA(03)
      A00085=B00011
!                      A00090 = DERIVATIVE OF A00088 W.R.T. ETA(04)
      A00090=B00013
!                      A00095 = DERIVATIVE OF A00093 W.R.T. ETA(05)
      A00095=B00015
!                      A00097 = DERIVATIVE OF A00096 W.R.T. ETA(02)
      A00097=B00016*A00080
      GG(01,02,02)=A00075
      GG(02,03,03)=A00080
      GG(03,05,05)=A00090
      GG(04,06,06)=A00095
      GG(05,04,04)=A00085
      GG(07,03,03)=A00097
      ENDIF
      RETURN
      END
